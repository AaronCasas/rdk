<html>
  <head>
    <script>
      function roverAction(action) {
          var path = "/api/rover?a=" + action + "&speed=" + document.getElementById("speed").value;
          console.log(path);
          var xhttp = new XMLHttpRequest();
          xhttp.open("GET", path, true);
          xhttp.send();
      }

      window.onkeypress = function(k) {
          switch (k.key) {
          case "s":
              roverAction("stop");
              break;
          case "i":
              updateImages();
              break;
          }

      }

      function updateImages() {
          var host = window.location.host.split(":")[0];
          var base = "http://" + host + ":8181/pic.png?ts=" + (new Date()).getTime() + "&num=";
          console.log(base);
          
          document.getElementById("i0").src = base + "0";
          document.getElementById("i1").src = base + "1";
          
      }

      function started() {
          setInterval(updateImages, 1000);
      }
      
    </script>
  </head>
  <body onLoad="started()">
    <ul>
      {{ range $a := .Actions }}
      <li>
        <button onclick="roverAction('{{ $a.Name }}')">{{ $a.Name }}</button>
      </li>
      {{ end }}

    </ul>

    Speed: <input id="speed" name="speed" value="64"/><br>

    <img id="i0" src=""/><br>
    <img id="i1" src=""/><br>
    
  </body>
</html>
